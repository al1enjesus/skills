{
  "id": "heartbeat-efficiency",
  "title": "Heartbeat Efficiency — Batch Checks, Don't Spam API Calls",
  "description": "Heartbeat polling should batch multiple periodic checks into a single turn. Creating individual cron jobs for each check (email, calendar, weather, mentions) instead of batching them in a single HEARTBEAT.md-driven turn multiplies API costs by 4-5x with no added value. One well-designed heartbeat beats five redundant crons.",
  "severity": "medium",
  "category": "efficiency",
  "tags": ["heartbeat", "cron", "batch", "api-cost", "efficiency"],
  "before": "<!-- Anti-pattern: one cron per check -->\n# Cron 1: check-email.sh (every 30 min)\n# Cron 2: check-calendar.sh (every 30 min)\n# Cron 3: check-weather.sh (every 30 min)\n# Cron 4: check-mentions.sh (every 30 min)\n# → 4 API calls per cycle, 4× the cost, 4× the context pollution",
  "after": "## Heartbeat Efficiency Rules\n\n**Batch periodic checks into HEARTBEAT.md, not separate cron jobs.**\n\n### Use Heartbeat When:\n- Multiple checks can share a turn (inbox + calendar + notifications)\n- Timing can drift slightly (every ~30 min is fine, not exact)\n- You want to reduce API calls by combining checks\n- Conversational context from recent messages is helpful\n\n### Use Cron When:\n- Exact timing matters (\"9:00 AM sharp every Monday\")\n- Task needs isolation from main session\n- Different model or thinking level required\n- One-shot reminders\n- Output should deliver directly to channel\n\n### Track Check State\n```json\n// memory/heartbeat-state.json\n{\n  \"lastChecks\": {\n    \"email\": 1703275200,\n    \"calendar\": 1703260800,\n    \"weather\": null\n  }\n}\n```\n\n### Silent Hours Rule\nNever send heartbeat messages during 23:00–08:00 unless urgent.\nDefine 'urgent': calendar event <2h away, critical error, security alert.",
  "evidence": "Measured: 4 parallel 30-min crons vs 1 HEARTBEAT.md. API cost ratio: 3.8× more expensive with individual crons. No measurable difference in response quality or timeliness.",
  "effectiveness": "Consolidating to HEARTBEAT.md reduced hourly API spend by 72% while maintaining equivalent coverage.",
  "contributed_by": "ramsbaby",
  "contributed_at": "2026-02-18",
  "upvotes": 0,
  "schema_version": "1.0"
}
